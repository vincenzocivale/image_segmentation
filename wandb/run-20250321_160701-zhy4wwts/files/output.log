Dataset caricato: 646 immagini con maschere corrispondenti
Divisione dataset: 451 train, 65 validation, 130 test
Some weights of SegformerForSemanticSegmentation were not initialized from the model checkpoint at nvidia/segformer-b0-finetuned-ade-512-512 and are newly initialized because the shapes did not match:
- decode_head.classifier.bias: found shape torch.Size([150]) in the checkpoint and torch.Size([5]) in the model instantiated
- decode_head.classifier.weight: found shape torch.Size([150, 256, 1, 1]) in the checkpoint and torch.Size([5, 256, 1, 1]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/inside-tech/Desktop/image_segmentation/.venv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.85it/s, loss=0.868, IoU=0.574, Dice=0.674]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.87it/s, loss=0.649, IoU=0.575, Dice=0.616]
Salvato il miglior modello con IoU: 0.6072
Epoch 1/50 - Train Loss: 1.1226, IoU: 0.4469, Dice: 0.5313 | Val Loss: 0.7445, IoU: 0.6072, Dice: 0.6906
Epoch 2/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.93it/s, loss=0.612, IoU=0.62, Dice=0.717] 
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.90it/s, loss=0.436, IoU=0.592, Dice=0.626]
Salvato il miglior modello con IoU: 0.6390
Epoch 2/50 - Train Loss: 0.7133, IoU: 0.6350, Dice: 0.7300 | Val Loss: 0.5736, IoU: 0.6390, Dice: 0.7242
Epoch 3/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.83it/s, loss=0.744, IoU=0.613, Dice=0.671]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.85it/s, loss=0.291, IoU=0.61, Dice=0.637] 
Salvato il miglior modello con IoU: 0.6764
Epoch 3/50 - Train Loss: 0.6298, IoU: 0.6545, Dice: 0.7477 | Val Loss: 0.4953, IoU: 0.6764, Dice: 0.7563
Epoch 4/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.81it/s, loss=0.538, IoU=0.726, Dice=0.827]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.86it/s, loss=0.317, IoU=0.585, Dice=0.621]
Epoch 4/50 - Train Loss: 0.5236, IoU: 0.6736, Dice: 0.7662 | Val Loss: 0.4824, IoU: 0.6470, Dice: 0.7306
Epoch 5/50 [Train]: 100%|██████████| 57/57 [00:15<00:00,  3.77it/s, loss=1.37, IoU=0.13, Dice=0.201]  
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.68it/s, loss=0.251, IoU=0.595, Dice=0.627]
Epoch 5/50 - Train Loss: 0.4858, IoU: 0.6813, Dice: 0.7713 | Val Loss: 0.4488, IoU: 0.6635, Dice: 0.7448
Epoch 6/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.90it/s, loss=1.03, IoU=0.448, Dice=0.584] 
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.81it/s, loss=0.141, IoU=0.636, Dice=0.651]
Salvato il miglior modello con IoU: 0.7186
Epoch 6/50 - Train Loss: 0.4468, IoU: 0.7024, Dice: 0.7916 | Val Loss: 0.3917, IoU: 0.7186, Dice: 0.7921
Epoch 7/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.82it/s, loss=0.435, IoU=0.751, Dice=0.836]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.76it/s, loss=0.205, IoU=0.613, Dice=0.638]
Salvato il miglior modello con IoU: 0.7267
Epoch 7/50 - Train Loss: 0.4135, IoU: 0.7168, Dice: 0.8033 | Val Loss: 0.3948, IoU: 0.7267, Dice: 0.8002
Epoch 8/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.83it/s, loss=0.307, IoU=0.808, Dice=0.885]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.78it/s, loss=0.156, IoU=0.632, Dice=0.648]
Epoch 8/50 - Train Loss: 0.3910, IoU: 0.7266, Dice: 0.8115 | Val Loss: 0.3895, IoU: 0.7037, Dice: 0.7787
Epoch 9/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.84it/s, loss=0.502, IoU=0.735, Dice=0.83] 
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.33it/s, loss=0.139, IoU=0.626, Dice=0.645]
Epoch 9/50 - Train Loss: 0.3727, IoU: 0.7333, Dice: 0.8175 | Val Loss: 0.3793, IoU: 0.7156, Dice: 0.7893
Epoch 10/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.88it/s, loss=0.405, IoU=0.714, Dice=0.8]  
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.76it/s, loss=0.228, IoU=0.598, Dice=0.628]
Epoch 10/50 - Train Loss: 0.3586, IoU: 0.7398, Dice: 0.8234 | Val Loss: 0.3834, IoU: 0.7020, Dice: 0.7786
Epoch 11/50 [Train]: 100%|██████████| 57/57 [00:15<00:00,  3.79it/s, loss=0.496, IoU=0.706, Dice=0.791]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.76it/s, loss=0.103, IoU=0.64, Dice=0.653] 
Epoch 11/50 - Train Loss: 0.3450, IoU: 0.7449, Dice: 0.8276 | Val Loss: 0.3957, IoU: 0.7021, Dice: 0.7774
Epoch 12/50 [Train]: 100%|██████████| 57/57 [00:15<00:00,  3.69it/s, loss=0.393, IoU=0.725, Dice=0.804]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.57it/s, loss=0.153, IoU=0.619, Dice=0.641]
Epoch 12/50 - Train Loss: 0.3275, IoU: 0.7527, Dice: 0.8340 | Val Loss: 0.4016, IoU: 0.6949, Dice: 0.7714
Epoch 13/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.83it/s, loss=0.284, IoU=0.764, Dice=0.851]
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.75it/s, loss=0.157, IoU=0.62, Dice=0.641] 
Salvato il miglior modello con IoU: 0.7269
Epoch 13/50 - Train Loss: 0.3102, IoU: 0.7621, Dice: 0.8421 | Val Loss: 0.3864, IoU: 0.7269, Dice: 0.7989
Epoch 14/50 [Train]: 100%|██████████| 57/57 [00:14<00:00,  3.80it/s, loss=0.437, IoU=0.744, Dice=0.83] 
Validation: 100%|██████████| 9/9 [00:02<00:00,  3.59it/s, loss=0.0978, IoU=0.641, Dice=0.653]
Epoch 14/50 - Train Loss: 0.3056, IoU: 0.7658, Dice: 0.8455 | Val Loss: 0.3723, IoU: 0.7125, Dice: 0.7866
Epoch 15/50 [Train]:  47%|████▋     | 27/57 [00:07<00:05,  5.33it/s, loss=0.331, IoU=0.755, Dice=0.833]
